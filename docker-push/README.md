<!-- Generated by https://github.com/reakaleek/gh-action-readme -->
# <!--name-->docker-push<!--/name-->

<!--description-->
This GitHub Action is designed to push Docker images to Google Artifact
Registry (GAR) and optionally GitHub Container Registry (GHCR).
<!--/description-->


## Inputs

<!--inputs-->
| Name                                    | Description                                                           | Required | Default           |
|-----------------------------------------|-----------------------------------------------------------------------|----------|-------------------|
| `image_tags`                            | Newline-delimited list of images to be pushed                         | `true`   | ` `               |
| `workload_identity_pool_project_number` | Project number of workload identity pool used for OIDC authentication | `true`   | ` `               |
| `project_id`                            | GCP project_id used to construct the service account                  | `true`   | ` `               |
| `gar_location`                          | GCP region where target GAR is located                                | `false`  | `us`              |
| `should_authenticate_to_ghcr`           | Whether or not to authenticate to Github Container Registry           | `false`  | `false`           |
| `service_account_name`                  | Service account used to authenticate to GAR                           | `false`  | `artifact-writer` |
<!--/inputs-->

### Input Details

#### `image_tags`

The `image_tags` input is typically generated by [`mozilla-it/deploy-actions/docker-build`](../docker-build/README.md), but may also be provided manually. See [GAR][1] and [GHCR][2] documentation for how to tag images for these supported registries.

#### `workload_identity_pool_project_number`

This value should be available as the repository variable `vars.GCPV2_WORKLOAD_IDENTITY_POOL_PROJECT_NUMBER`.

[1]: https://cloud.google.com/artifact-registry/docs/docker/pushing-and-pulling#tag
[2]: https://docs.github.com/en/packages/working-with-a-github-packages-registry/working-with-the-container-registry#pushing-container-images

## Example Usage

```yaml
- name: Push Docker image to GAR and GHCR
  uses: mozilla-it/deploy-actions/docker-push@v4
  with:
    # typically provided from another step's output
    image_tags: |-
      ghcr.io/mozilla/my-repo/my-service:v1.0.0
      us-docker.pkg.dev/moz-fx-tenant-prod/tenant-prod/my-service:v1.0.0
    should_authenticate_to_ghcr: true
    project_id: moz-fx-tenant-prod
    workload_identity_pool_project_number: ${{ vars.GCPV2_WORKLOAD_IDENTITY_POOL_PROJECT_NUMBER }}
```
